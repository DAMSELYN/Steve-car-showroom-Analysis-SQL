CREATE DATABASE STEELDATA;
USE STEELDATA;
CREATE TABLE cars (
    car_id INT PRIMARY KEY,
    make VARCHAR(50),
    type VARCHAR(50),
    style VARCHAR(50),
    cost_$ INT
);
--------------------
INSERT INTO cars (car_id, make, type, style, cost_$)
VALUES (1, 'Honda', 'Civic', 'Sedan', 30000),
(2, 'Toyota', 'Corolla', 'Hatchback', 25000),
(3, 'Ford', 'Explorer', 'SUV', 40000),
(4, 'Chevrolet', 'Camaro', 'Coupe', 36000),
(5, 'BMW', 'X5', 'SUV', 55000),
(6, 'Audi', 'A4', 'Sedan', 48000),
(7, 'Mercedes', 'C-Class', 'Coupe', 60000),
(8, 'Nissan', 'Altima', 'Sedan', 26000);
--------------------
CREATE TABLE salespersons (
salesman_id INT PRIMARY KEY,
name VARCHAR(50),
age INT,
city VARCHAR(50)
);
--------------------
INSERT INTO salespersons (salesman_id, name, age, city)
VALUES (1, 'John Smith', 28, 'New York'),
(2, 'Emily Wong', 35, 'San Fran'),
(3, 'Tom Lee', 42, 'Seattle'),
(4, 'Lucy Chen', 31, 'LA');
--------------------
CREATE TABLE sales (
sale_id INT PRIMARY KEY,
car_id INT,
salesman_id INT,
purchase_date DATE,
FOREIGN KEY (car_id) REFERENCES cars(car_id),
FOREIGN KEY (salesman_id) REFERENCES salespersons(salesman_id)
);
--------------------
INSERT INTO sales (sale_id, car_id, salesman_id, purchase_date)
VALUES (1, 1, 1, '2021-01-01'),
(2, 3, 3, '2021-02-03'),
(3, 2, 2, '2021-02-10'),
(4, 5, 4, '2021-03-01'),
(5, 8, 1, '2021-04-02'),
(6, 2, 1, '2021-05-05'),
(7, 4, 2, '2021-06-07'),
(8, 5, 3, '2021-07-09'),
(9, 2, 4, '2022-01-01'),
(10, 1, 3, '2022-02-03'),
(11, 8, 2, '2022-02-10'),
(12, 7, 2, '2022-03-01'),
(13, 5, 3, '2022-04-02'),
(14, 3, 1, '2022-05-05'),
(15, 5, 4, '2022-06-07'),
(16, 1, 2, '2022-07-09'),
(17, 2, 3, '2023-01-01'),
(18, 6, 3, '2023-02-03'),
(19, 7, 1, '2023-02-10'),
(20, 4, 4, '2023-03-01');
















-- 	Q1. What are the details of all cars purchased in the year 2022?
SELECT 
    *, purchase_date
FROM
    cars c
        LEFT JOIN
    sales s ON c.car_id = s.car_id
WHERE
    purchase_date BETWEEN '2022-01-01' AND '2022-12-31';

-- 2. What is the total number of cars sold by each salesperson?
SELECT 
    COUNT(car_id), name
FROM
    sales s
        INNER JOIN
    salespersons p ON s.salesman_id = p.salesman_id
GROUP BY name;

 
-- Q3 What is the total revenue generated by each salesperson?
SELECT 
    name, SUM(cost_$) AS total_revenue
FROM
    sales s
        INNER JOIN
    cars c ON c.car_id = s.car_id
        LEFT JOIN
    salespersons p ON p.salesman_id = s.salesman_id
GROUP BY name;


-- Q4. What are the details of the cars sold by each salesperson?
SELECT 
    name, make, type, style, cost_$
FROM
    sales s
        LEFT JOIN
    cars c ON c.car_id = s.car_id
        LEFT JOIN
    salespersons p ON p.salesman_id = s.salesman_id
;

-- Q5 What is the total revenue generated by each car type?
SELECT 
    type, SUM(cost_$) AS total_revenue
FROM
    cars c
        INNER JOIN
    sales s ON c.car_id = s.car_id
GROUP BY type;
-- Q6 What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?
SELECT 
    name, make, type, style, cost_$
FROM
    sales s
        LEFT JOIN
    cars c ON c.car_id = s.car_id
        LEFT JOIN
    salespersons p ON p.salesman_id = s.salesman_id
WHERE
    name = 'Emily Wong'
        AND purchase_date BETWEEN '2021-01-01' AND '2021-12-31';


-- Q7What is the total revenue generated by the sales of hatchback cars?
SELECT 
    style, SUM(cost_$) AS total_revenue
FROM
    cars c
        INNER JOIN
    sales s ON c.car_id = s.car_id
WHERE
    style = 'hatchback';


-- Q8 What is the total revenue generated by the sales of SUV cars in the year 2022?
SELECT 
    style, SUM(cost_$) AS total_revenue
FROM
    cars c
        INNER JOIN
    sales s ON c.car_id = s.car_id
WHERE
    style = 'SUV'
        AND purchase_date BETWEEN '2022-01-01' AND '2022-12-31';


-- Q9 What is the name and city of the salesperson who sold the most number of cars in the year 2023?
SELECT 
    COUNT(car_id) AS max_sold, name, city
FROM
    sales s
        INNER JOIN
    salespersons p ON s.salesman_id = p.salesman_id
WHERE
    s.purchase_date BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY name , city
ORDER BY max_sold DESC
LIMIT 1;

-- Q10.. What is the name and age of the salesperson who generated the highest revenue in the year 2022?
SELECT 
    SUM(cost_$) AS max_revenue, name, age
FROM
    cars c
        INNER JOIN
    sales s ON c.car_id = s.car_id
        INNER JOIN
    salespersons p ON s.salesman_id = p.salesman_id
WHERE
    s.purchase_date BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY name , age
ORDER BY max_revenue DESC
LIMIT 1;

